<!doctype html>
<script src="https://kit.fontawesome.com/d7cf9532bd.js" crossorigin="anonymous"></script>
<script src="../js/toggle.js"></script>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Stephan Schiffels - Xerxes's cutlery - enjoying your dinner?</title>
        <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"> -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
        <!-- <link rel="stylesheet" href="/css/default.css" /> -->
    </head>
    <body>
        <div class="container">
            <header class="section">
            <h1 class="title is-1">
                <a href="../">Stephan Schiffels</a>
            </h1>
            <h2 class="subtitle">
                Population Genetics – Computational Methods - Human History
            </h2>
            <nav class="navbar">
                <div class="navbar-brand">
                    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                <div class="navbar-menu" id="navMenu">
                    <div class="navbar-start">
                        <a href="../news.html" class="navbar-item">News</a>
                        <a href="../publications.html" class="navbar-item">Publications</a>
                        <a href="../talks.html" class="navbar-item">Talks</a>
                        <a href="../resources.html" class="navbar-item">Resources</a>
                        <a target="_blank" rel="noopener noreferrer" href="https://www.eva.mpg.de/archaeogenetics/research-groups/population-genetics/" class="navbar-item">Research Group<i style="font-size:12px" class="ml-1 fa-solid fa-arrow-up-right-from-square"></i></a>
                        <a href="../blog.html" class="navbar-item">Blog</a>
                    </div>
                    <div class="navbar end">
                        <a class="navbar-item" href="https://www.eva.mpg.de/archaeogenetics/staff/stephan-schiffels/"><img src="../images/mpi_logo.jpg"></a>
                        <a class="navbar-item" href="https://twitter.com/stschiff"><span class="icon is-large"><i class="fa-brands fa-twitter fa-2xl"></i></span></a>
                        <a class="navbar-item" href="https://github.com/stschiff"><span class="icon is-large"><i class="fa-brands fa-github fa-2xl"></i></span></a>
                        <a class="navbar-item" href="https://medium.com/stephan-schiffels"><span class="icon is-large"><i class="fa-brands fa-medium fa-2xl"></i></span></a>
                        <a class="navbar-item" href="https://www.researchgate.net/profile/Stephan_Schiffels"><span class="icon is-large"><i class="fa-brands fa-researchgate fa-2xl"></i></span></a>
                        <a class="navbar-item" rel="me" href="https://ecoevo.social/@stschiff"><span class="icon is-large"><i class="fa-brands fa-mastodon fa-2xl"></i></span></a>
                    </div>
                </div>
            </nav>

            </header>

            <main class="section">
                <h1 class="title is-2">Xerxes's cutlery - enjoying your dinner?</h1>
                <div class="content">
                    <div class="mb-5"><a href="../blog.html"><i>← All Blog Posts</i></a></div>
<article>
    <header>
        Posted on October 27, 2023
        
            by Stephan Schiffels
        
        Categories: blog
    </header>
    
        <img src="../images/oliver-augustijn-4Af55Wg3vEs-unsplash.jpg">
    
    <p><em>This post was originally published on <a href="https://blog.poseidon-adna.org/posts/xerxes_10.html">the Poseidon Blog</a></em></p>
<p><em>Image credit by Unsplash</em></p>
<p>So, you’ve <a href="../posts/2023-10-04-trident.html">ordered your food</a>, now what?</p>
<p>Often, we want to summarise the genetic data through summary statistics. Examples for such summary statistics are F-Statistics. Our tool <code>xerxes fstats</code>, which is <a href="https://www.poseidon-adna.org/#/xerxes">part of the Poseidon ecosystem</a>, provides a powerful and expressive tool to compute such summary statistics from genetic data described in Poseidon packages.</p>
<!--more-->
<p>Specifically, you can for example reproduce the <a href="https://www.science.org/doi/10.1126/science.1188021?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200pubmed">famous F4 statistics</a> that first showed that Neandertalers, a group of close human relatives that disappeared around 45,000 years ago, interbred with modern human ancestors.</p>
<p>This is its form: <code>F4(Chimpanzee, Neandertaler, African, European)</code>. It is defined in terms of average allele frequency correlation across a set of genetic positions.</p>
<p>So, which Chimpanzee, Neandertaler, African and European groups do we have in our datasets on our servers? Let’s find out:</p>
<pre><code>&gt; trident list --remote --groups | grep Chimp
trident v1.3.0.4 for poseidon v2.5.0, v2.6.0, v2.7.0, v2.7.1
https://poseidon-framework.github.io

[Info]    Downloading group data from server
[Info]    Message from the Server: Greetings from the Poseidon Server, version 1.3.0.4
| Chimp.REF                                                    | Reference_Genomes                       | 2.2.0           | 1              |</code></pre>
<p>Cool, so there is a group called <code>Chimp.REF</code> in a package called “Reference Genomes” which looks right. What about Neandertals?</p>
<pre><code>&gt; trident list --remote --groups | grep Neanderthal
trident v1.3.0.4 for poseidon v2.5.0, v2.6.0, v2.7.0, v2.7.1
https://poseidon-framework.github.io

[Info]    Downloading group data from server
[Info]    Message from the Server: Greetings from the Poseidon Server, version 1.3.0.4
| Altai_Neanderthal.DG                                         | Archaic_Humans                          | 2.2.0           | 1              |
| Altai_Neanderthal_published.DG                               | Archaic_Humans                          | 2.2.0           | 1              |
| Chagyrskaya_Neanderthal.SG                                   | 2020_Mafessoni_Neanderthal              | 0.2.0           | 1              |
| DenisovaNeanderthalMix.SG                                    | Archaic_Humans                          | 2.2.0           | 1              |
| Goyet_Neanderthal.SG                                         | Archaic_Humans                          | 2.2.0           | 1              |
| LesCottes_Neanderthal.SG                                     | Archaic_Humans                          | 2.2.0           | 1              |
| Mezmaiskaya1_Neanderthal.SG                                  | Archaic_Humans                          | 2.2.0           | 1              |
| Mezmaiskaya2_Neanderthal.SG                                  | Archaic_Humans                          | 2.2.0           | 1              |
| Spy_Neanderthal.SG                                           | Archaic_Humans                          | 2.2.0           | 1              |
| VindijaG1_Neanderthal.SG                                     | Archaic_Humans                          | 2.2.0           | 1              |</code></pre>
<p>Cool, those are a lot. We’ll just go with <code>Altai_Neanderthal.DG</code>.</p>
<p>For the African and Europeans, you can do it similarly, but I’m just telling you that we want “Yoruba” (from Nigeria) and “French” (from, well, France).</p>
<p>So how do you get the data? Easy enough. You can just order your meal, remember? Here is the way to download the packages <em>without even knowing which packages</em>:</p>
<pre><code>trident fetch -d ~/poseidon_repo -f 'Chimp.REF,Altai_Neanderthal.DG,Yoruba,French'</code></pre>
<p>This will download the relevant packages into a repository location specified by <code>-d</code>. You can then just run:</p>
<pre><code>xerxes fstats -d ~/poseidon_repo --stat 'F4(Chimp.REF,Altai_Neanderthal.DG,Yoruba,French)'</code></pre>
<p>Here, <code>-d</code> gives the location of your package repository. This runs and outputs a bunch of stuff, and then closes with:</p>
<pre><code>.-----------.-----------.----------------------.--------.--------.---------.----------------.--------------------.------------------.-------------------.
| Statistic |     a     |          b           |   c    |   d    | NrSites | Estimate_Total | Estimate_Jackknife | StdErr_Jackknife | Z_score_Jackknife |
:===========:===========:======================:========:========:=========:================:====================:==================:===================:
| F4        | Chimp.REF | Altai_Neanderthal.DG | Yoruba | French | 549812  | 1.5083e-3      | 1.5083e-3          | 1.9721e-4        | 7.648265856488313 |
'-----------'-----------'----------------------'--------'--------'---------'----------------'--------------------'------------------'-------------------'</code></pre>
<p>The very last number shows that this statistic is significantly positive (i.e. has a Z-score above 3), which shows that Altai_Neanderthal.DG is significantly more closely related to French than to Yoruba.</p>
<p>Of course, <code>xerxes fstats</code> can do a lot more, and you can read about it in our <a href="https://www.poseidon-adna.org/#/xerxes?id=fstats-command">documentation</a>.</p>
<p>We have also added a <a href="https://github.com/poseidon-framework/poseidon-analysis-hs/blob/updates_poseidon_1.4/docs/xerxes_whitepaper.pdf">detailed whitepaper</a> now, which describes the mathematical details of the methods implemented here. For example, here is the table of listed statistics from the whitepaper:</p>
<figure>
<img src="../images/fstats_table.jpg" alt="A table of F-Statistics" />
<figcaption aria-hidden="true">A table of F-Statistics</figcaption>
</figure>
<p>F-Statistics are one important analysis tool used in the field, but there are of course a lot more, and we hope to implement some more in xerxes in the future.</p>
</article>

                </div>
            </main>

            <footer class="footer has-text-centered">
                Powered by
                <a href="http://jaspervdj.be/hakyll">Hakyll</a> and <a href="https://bulma.io">Bulma</a>. Sourcecode available on
                <a href="https://github.com/stschiff/stschiff.github.io">github</a>.
            </footer>
        </div>
    </body>
</html>
